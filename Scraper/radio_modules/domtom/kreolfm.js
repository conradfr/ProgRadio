let moment = require('moment-timezone');
const logger = require('../../lib/logger.js');

const format = dateObj => {
    let startDateTime = moment(dateObj);
    startDateTime.hour(0);
    startDateTime.minute(0);
    startDateTime.second(0);

    let endDateTime = moment(dateObj);
    endDateTime.hour(0);
    endDateTime.minute(0);
    endDateTime.second(0);
    endDateTime.add(1, 'days');

    const newEntry = {
      'title': 'Ekout ta war',
      'description': "Kréol FM est une station radio de l'Île de La Réunion fondée en 1992 par Thierry ARAYE.",
      'img': 'data:image/jpeg;base64,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',
      'date_time_start': startDateTime.toISOString(),
      'date_time_end': endDateTime.toISOString()
      // 'sections': subs
    };

  const cleanedData = [newEntry];
  return Promise.resolve(cleanedData);
};

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

const fetch = dateObj => {
  logger.log('info', `fetching static Kreol fm`);

  // For some reason we need to have a sleep otherwise save in redis fails
  return new Promise((resolve, reject) => {
    sleep(3000).then(() => {
      resolve(true);
    });
  });
};

const fetchAll = dateObj =>  {
  return fetch(dateObj);
};

const getScrap = dateObj => {
  return fetchAll(dateObj)
    .then(() => {
      return format(dateObj);
    });
};

const scrapModule = {
  getName: 'kreolfm',
  supportTomorrow: true,
  getScrap
};

module.exports = scrapModule;
