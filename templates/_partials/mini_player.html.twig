<audio id="videoplayer" playsinline="playsinline" style="display:none"></audio>
<script type="text/javascript">
  const PLAYER_STATE_STOPPED = 1;
  const PLAYER_STATE_PLAYING = 3;
  const PLAYER_STATE_LOADING = 42;
</script>
<script type="module">
{% verbatim %}
(()=>{"use strict";var e=Object.defineProperty,t=(t,s,n)=>(((t,s,n)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n})(t,"symbol"!=typeof s?s+"":s,n),n);function s(e){if(d(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=m(i)?o(i):s(i);if(r)for(const e in r)t[e]=r[e]}return t}return m(e)||y(e)?e:void 0}const n=/;(?![^(]*\))/g,i=/:(.+)/;function o(e){const t={};return e.split(n).forEach((e=>{if(e){const s=e.split(i);s.length>1&&(t[s[0].trim()]=s[1].trim())}})),t}function r(e){let t="";if(m(e))t=e;else if(d(e))for(let s=0;s<e.length;s++){const n=r(e[s]);n&&(t+=n+" ")}else if(y(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function l(e,t){if(e===t)return!0;let s=f(e),n=f(t);if(s||n)return!(!s||!n)&&e.getTime()===t.getTime();if(s=d(e),n=d(t),s||n)return!(!s||!n)&&function(e,t){if(e.length!==t.length)return!1;let s=!0;for(let n=0;s&&n<e.length;n++)s=l(e[n],t[n]);return s}(e,t);if(s=y(e),n=y(t),s||n){if(!s||!n)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e){const n=e.hasOwnProperty(s),i=t.hasOwnProperty(s);if(n&&!i||!n&&i||!l(e[s],t[s]))return!1}}return String(e)===String(t)}function a(e,t){return e.findIndex((e=>l(e,t)))}const h=Object.assign,c=Object.prototype.hasOwnProperty,u=(e,t)=>c.call(e,t),d=Array.isArray,p=e=>"[object Map]"===b(e),f=e=>e instanceof Date,m=e=>"string"==typeof e,g=e=>"symbol"==typeof e,y=e=>null!==e&&"object"==typeof e,v=Object.prototype.toString,b=e=>v.call(e),w=e=>m(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,k=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},C=/-(\w)/g,E=k((e=>e.replace(C,((e,t)=>t?t.toUpperCase():"")))),T=/\B([A-Z])/g,S=k((e=>e.replace(T,"-$1").toLowerCase())),j=e=>{const t=parseFloat(e);return isNaN(t)?e:t};function _(e,t){(t=t||undefined)&&t.active&&t.effects.push(e)}const R=e=>{const t=new Set(e);return t.w=0,t.n=0,t},$=e=>(e.w&P)>0,x=e=>(e.n&P)>0,A=new WeakMap;let O=0,P=1;const I=[];let L;const N=Symbol(""),M=Symbol("");class H{constructor(e,t=null,s){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],_(this,s)}run(){if(!this.active)return this.fn();if(!I.includes(this))try{return I.push(L=this),W.push(B),B=!0,P=1<<++O,O<=30?(({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=P})(this):U(this),this.fn()}finally{O<=30&&(e=>{const{deps:t}=e;if(t.length){let s=0;for(let n=0;n<t.length;n++){const i=t[n];$(i)&&!x(i)?i.delete(e):t[s++]=i,i.w&=~P,i.n&=~P}t.length=s}})(this),P=1<<--O,q(),I.pop();const e=I.length;L=e>0?I[e-1]:void 0}}stop(){this.active&&(U(this),this.onStop&&this.onStop(),this.active=!1)}}function U(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}function D(e){e.effect.stop()}let B=!0;const W=[];function q(){const e=W.pop();B=void 0===e||e}function J(e,t,s){if(!B||void 0===L)return;let n=A.get(e);n||A.set(e,n=new Map);let i=n.get(s);i||n.set(s,i=R()),function(e){let t=!1;O<=30?x(e)||(e.n|=P,t=!$(e)):t=!e.has(L),t&&(e.add(L),L.deps.push(e))}(i)}function F(e,t,s,n,i,o){const r=A.get(e);if(!r)return;let l=[];if("clear"===t)l=[...r.values()];else if("length"===s&&d(e))r.forEach(((e,t)=>{("length"===t||t>=n)&&l.push(e)}));else switch(void 0!==s&&l.push(r.get(s)),t){case"add":d(e)?w(s)&&l.push(r.get("length")):(l.push(r.get(N)),p(e)&&l.push(r.get(M)));break;case"delete":d(e)||(l.push(r.get(N)),p(e)&&l.push(r.get(M)));break;case"set":p(e)&&l.push(r.get(N))}if(1===l.length)l[0]&&G(l[0]);else{const e=[];for(const t of l)t&&e.push(...t);G(R(e))}}function G(e,t){for(const t of d(e)?e:[...e])(t!==L||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const K=function(e,t){const s=Object.create(null),n=e.split(",");for(let e=0;e<n.length;e++)s[n[e]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}("__proto__,__v_isRef,__isVue"),z=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(g)),V=Q(),Z=Q(!0),X=function(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const s=ae(this);for(let e=0,t=this.length;e<t;e++)J(s,0,e+"");const n=s[t](...e);return-1===n||!1===n?s[t](...e.map(ae)):n}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){W.push(B),B=!1;const s=ae(this)[t].apply(this,e);return q(),s}})),e}();function Q(e=!1,t=!1){return function(s,n,i){if("__v_isReactive"===n)return!e;if("__v_isReadonly"===n)return e;if("__v_raw"===n&&i===(e?t?ie:ne:t?se:te).get(s))return s;const o=d(s);if(!e&&o&&u(X,n))return Reflect.get(X,n,i);const r=Reflect.get(s,n,i);return(g(n)?z.has(n):K(n))||(e||J(s,0,n),t)?r:he(r)?o&&w(n)?r:r.value:y(r)?e?function(e){return le(e,!0,ee,null,ne)}(r):re(r):r}}const Y={get:V,set:function(e=!1){return function(t,s,n,i){let o=t[s];if(!e&&!function(e){return!(!e||!e.__v_isReadonly)}(n)&&(n=ae(n),o=ae(o),!d(t)&&he(o)&&!he(n)))return o.value=n,!0;const r=d(t)&&w(s)?Number(s)<t.length:u(t,s),l=Reflect.set(t,s,n,i);return t===ae(i)&&(r?((e,t)=>!Object.is(e,t))(n,o)&&F(t,"set",s,n):F(t,"add",s,n)),l}}(),deleteProperty:function(e,t){const s=u(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&s&&F(e,"delete",t,void 0),n},has:function(e,t){const s=Reflect.has(e,t);return(!g(t)||!z.has(t))&&J(e,0,t),s},ownKeys:function(e){return J(e,0,d(e)?"length":N),Reflect.ownKeys(e)}},ee={get:Z,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},te=new WeakMap,se=new WeakMap,ne=new WeakMap,ie=new WeakMap;function oe(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>b(e).slice(8,-1))(e))}function re(e){return e&&e.__v_isReadonly?e:le(e,!1,Y,null,te)}function le(e,t,s,n,i){if(!y(e)||e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=i.get(e);if(o)return o;const r=oe(e);if(0===r)return e;const l=new Proxy(e,2===r?n:s);return i.set(e,l),l}function ae(e){const t=e&&e.__v_raw;return t?ae(t):e}function he(e){return Boolean(e&&!0===e.__v_isRef)}Promise.resolve();let ce=!1;const ue=[],de=Promise.resolve(),pe=e=>de.then(e),fe=e=>{ue.includes(e)||ue.push(e),ce||(ce=!0,pe(me))},me=()=>{for(const e of ue)e();ue.length=0,ce=!1},ge=/^(spellcheck|draggable|form|list|type)$/,ye=({el:e,get:t,effect:s,arg:n,modifiers:i})=>{let o;"class"===n&&(e._class=e.className),s((()=>{let s=t();if(n)(null==i?void 0:i.camel)&&(n=E(n)),ve(e,n,s,o);else{for(const t in s)ve(e,t,s[t],o&&o[t]);for(const t in o)(!s||!(t in s))&&ve(e,t,null)}o=s}))},ve=(e,t,n,i)=>{if("class"===t)e.setAttribute("class",r(e._class?[e._class,n]:n)||"");else if("style"===t){n=s(n);const{style:t}=e;if(n)if(m(n))n!==i&&(t.cssText=n);else{for(const e in n)we(t,e,n[e]);if(i&&!m(i))for(const e in i)null==n[e]&&we(t,e,"")}else e.removeAttribute("style")}else e instanceof SVGElement||!(t in e)||ge.test(t)?"true-value"===t?e._trueValue=n:"false-value"===t?e._falseValue=n:null!=n?e.setAttribute(t,n):e.removeAttribute(t):(e[t]=n,"value"===t&&(e._value=n))},be=/\s*!important$/,we=(e,t,s)=>{d(s)?s.forEach((s=>we(e,t,s))):t.startsWith("--")?e.setProperty(t,s):be.test(s)?e.setProperty(S(t),s.replace(be,""),"important"):e[t]=s},ke=(e,t)=>{const s=e.getAttribute(t);return null!=s&&e.removeAttribute(t),s},Ce=(e,t,s,n)=>{e.addEventListener(t,s,n)},Ee=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Te=["ctrl","shift","alt","meta"],Se={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Te.some((s=>e[`${s}Key`]&&!t[s]))},je=({el:e,get:t,exp:s,arg:n,modifiers:i})=>{if(!n)return;let o=Ee.test(s)?t(`(e => ${s}(e))`):t(`($event => { ${s} })`);if("vue:mounted"!==n){if("vue:unmounted"===n)return()=>o();if(i){"click"===n&&(i.right&&(n="contextmenu"),i.middle&&(n="mouseup"));const e=o;o=t=>{if(!("key"in t)||S(t.key)in i){for(const e in i){const s=Se[e];if(s&&s(t,i))return}return e(t)}}}Ce(e,n,o,i)}else pe(o)},_e=({el:e,get:t,effect:s})=>{s((()=>{e.textContent=Re(t())}))},Re=e=>null==e?"":y(e)?JSON.stringify(e,null,2):String(e),$e=e=>"_value"in e?e._value:e.value,xe=(e,t)=>{const s=t?"_trueValue":"_falseValue";return s in e?e[s]:t},Ae=e=>{e.target.composing=!0},Oe=e=>{const t=e.target;t.composing&&(t.composing=!1,Pe(t,"input"))},Pe=(e,t)=>{const s=document.createEvent("HTMLEvents");s.initEvent(t,!0,!0),e.dispatchEvent(s)},Ie=Object.create(null),Le=(e,t,s)=>Ne(e,`return(${t})`,s),Ne=(e,t,s)=>{const n=Ie[t]||(Ie[t]=Me(t));try{return n(e,s)}catch(e){console.error(e)}},Me=e=>{try{return new Function("$data","$el",`with($data){${e}}`)}catch(t){return console.error(`${t.message} in expression: ${e}`),()=>{}}},He={bind:ye,on:je,show:({el:e,get:t,effect:s})=>{const n=e.style.display;s((()=>{e.style.display=t()?n:"none"}))},text:_e,html:({el:e,get:t,effect:s})=>{s((()=>{e.innerHTML=t()}))},model:({el:e,exp:t,get:s,effect:n,modifiers:i})=>{const o=e.type,r=s(`(val) => { ${t} = val }`),{trim:h,number:c="number"===o}=i||{};if("SELECT"===e.tagName){const t=e;Ce(e,"change",(()=>{const e=Array.prototype.filter.call(t.options,(e=>e.selected)).map((e=>c?j($e(e)):$e(e)));r(t.multiple?e:e[0])})),n((()=>{const e=s(),n=t.multiple;for(let s=0,i=t.options.length;s<i;s++){const i=t.options[s],o=$e(i);if(n)d(e)?i.selected=a(e,o)>-1:i.selected=e.has(o);else if(l($e(i),e))return void(t.selectedIndex!==s&&(t.selectedIndex=s))}!n&&-1!==t.selectedIndex&&(t.selectedIndex=-1)}))}else if("checkbox"===o){let t;Ce(e,"change",(()=>{const t=s(),n=e.checked;if(d(t)){const s=$e(e),i=a(t,s),o=-1!==i;if(n&&!o)r(t.concat(s));else if(!n&&o){const e=[...t];e.splice(i,1),r(e)}}else r(xe(e,n))})),n((()=>{const n=s();d(n)?e.checked=a(n,$e(e))>-1:n!==t&&(e.checked=l(n,xe(e,!0))),t=n}))}else if("radio"===o){let t;Ce(e,"change",(()=>{r($e(e))})),n((()=>{const n=s();n!==t&&(e.checked=l(n,$e(e)))}))}else{const t=e=>h?e.trim():c?j(e):e;Ce(e,"compositionstart",Ae),Ce(e,"compositionend",Oe),Ce(e,(null==i?void 0:i.lazy)?"change":"input",(()=>{e.composing||r(t(e.value))})),h&&Ce(e,"change",(()=>{e.value=e.value.trim()})),n((()=>{if(e.composing)return;const n=e.value,i=s();document.activeElement===e&&t(n)===i||n!==i&&(e.value=i)}))}},effect:({el:e,ctx:t,exp:s,effect:n})=>{pe((()=>n((()=>Ne(t.scope,s,e)))))}},Ue=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,De=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Be=/^\(|\)$/g,We=/^[{[]\s*((?:[\w_$]+\s*,?\s*)+)[\]}]$/,qe=(e,t,s)=>{const n=t.match(Ue);if(!n)return;const i=e.nextSibling,o=e.parentElement,r=new Text("");o.insertBefore(r,e),o.removeChild(e);const l=n[2].trim();let a,h,c,u,p=n[1].trim().replace(Be,"").trim(),f=!1,m="key",g=e.getAttribute(m)||e.getAttribute(m=":key")||e.getAttribute(m="v-bind:key");g&&(e.removeAttribute(m),"key"===m&&(g=JSON.stringify(g))),(u=p.match(De))&&(p=p.replace(De,"").trim(),h=u[1].trim(),u[2]&&(c=u[2].trim())),(u=p.match(We))&&(a=u[1].split(",").map((e=>e.trim())),f="["===p[0]);let v,b,w,k=!1;const C=(e,t,n,i)=>{const o={};a?a.forEach(((e,s)=>o[e]=t[f?s:e])):o[p]=t,i?(h&&(o[h]=i),c&&(o[c]=n)):h&&(o[h]=n);const r=et(s,o),l=g?Le(r.scope,g):n;return e.set(l,n),r.key=l,r},E=(t,s)=>{const n=new st(e,t);return n.key=t.key,n.insert(o,s),n};return s.effect((()=>{const e=Le(s.scope,l),t=w;if([b,w]=(e=>{const t=new Map,s=[];if(d(e))for(let n=0;n<e.length;n++)s.push(C(t,e[n],n));else if("number"==typeof e)for(let n=0;n<e;n++)s.push(C(t,n+1,n));else if(y(e)){let n=0;for(const i in e)s.push(C(t,e[i],n++,i))}return[s,t]})(e),k){for(let e=0;e<v.length;e++)w.has(v[e].key)||v[e].remove();const e=[];let s,n,i=b.length;for(;i--;){const l=b[i],a=t.get(l.key);let h;null==a?h=E(l,s?s.el:r):(h=v[a],Object.assign(h.ctx.scope,l.scope),a!==i&&(v[a+1]!==s||n===s)&&(n=h,h.insert(o,s?s.el:r))),e.unshift(s=h)}v=e}else v=b.map((e=>E(e,r))),k=!0})),i},Je=({el:e,ctx:{scope:{$refs:t}},get:s,effect:n})=>{let i;return n((()=>{const n=s();t[n]=e,i&&n!==i&&delete t[i],i=n})),()=>{i&&delete t[i]}},Fe=/^(?:v-|:|@)/,Ge=/\.([\w-]+)/g;let Ke=!1;const ze=(e,t)=>{const s=e.nodeType;if(1===s){const s=e;if(s.hasAttribute("v-pre"))return;let n;if(ke(s,"v-cloak"),n=ke(s,"v-if"))return((e,t,s)=>{const n=e.parentElement,i=new Comment("v-if");n.insertBefore(i,e);const o=[{exp:t,el:e}];let r,l;for(;(r=e.nextElementSibling)&&(l=null,""===ke(r,"v-else")||(l=ke(r,"v-else-if")));)n.removeChild(r),o.push({exp:l,el:r});const a=e.nextSibling;n.removeChild(e);let h,c=-1;const u=()=>{h&&(n.insertBefore(i,h.el),h.remove(),h=void 0)};return s.effect((()=>{for(let e=0;e<o.length;e++){const{exp:t,el:r}=o[e];if(!t||Le(s.scope,t))return void(e!==c&&(u(),h=new st(r,s),h.insert(n,i),n.removeChild(i),c=e))}c=-1,u()})),a})(s,n,t);if(n=ke(s,"v-for"))return qe(s,n,t);if((n=ke(s,"v-scope"))||""===n){const e=n?Le(t.scope,n):{};t=et(t,e),e.$template&&Qe(s,e.$template)}const i=null!=ke(s,"v-once");i&&(Ke=!0),(n=ke(s,"ref"))&&Xe(s,Je,`"${n}"`,t),Ve(s,t);const o=[];for(const{name:e,value:n}of[...s.attributes])Fe.test(e)&&"v-cloak"!==e&&("v-model"===e?o.unshift([e,n]):"@"===e[0]||/^v-on\b/.test(e)?o.push([e,n]):Ze(s,e,n,t));for(const[e,n]of o)Ze(s,e,n,t);i&&(Ke=!1)}else if(3===s){const s=e.data;if(s.includes(t.delimiters[0])){let n,i=[],o=0;for(;n=t.delimitersRE.exec(s);){const e=s.slice(o,n.index);e&&i.push(JSON.stringify(e)),i.push(`$s(${n[1]})`),o=n.index+n[0].length}o<s.length&&i.push(JSON.stringify(s.slice(o))),Xe(e,_e,i.join("+"),t)}}else 11===s&&Ve(e,t)},Ve=(e,t)=>{let s=e.firstChild;for(;s;)s=ze(s,t)||s.nextSibling},Ze=(e,t,s,n)=>{let i,o,r;if(":"===(t=t.replace(Ge,((e,t)=>((r||(r={}))[t]=!0,""))))[0])i=ye,o=t.slice(1);else if("@"===t[0])i=je,o=t.slice(1);else{const e=t.indexOf(":"),s=e>0?t.slice(2,e):t.slice(2);i=He[s]||n.dirs[s],o=e>0?t.slice(e+1):void 0}i&&(i===ye&&"ref"===o&&(i=Je),Xe(e,i,s,n,o,r),e.removeAttribute(t))},Xe=(e,t,s,n,i,o)=>{const r=t({el:e,get:(t=s)=>Le(n.scope,t,e),effect:n.effect,ctx:n,exp:s,arg:i,modifiers:o});r&&n.cleanups.push(r)},Qe=(e,t)=>{if("#"!==t[0])e.innerHTML=t;else{const s=document.querySelector(t);e.appendChild(s.content.cloneNode(!0))}},Ye=e=>{const t={delimiters:["{{","}}"],delimitersRE:/\{\{([^]+?)\}\}/g,...e,scope:e?e.scope:re({}),dirs:e?e.dirs:{},effects:[],blocks:[],cleanups:[],effect:e=>{if(Ke)return fe(e),e;const s=function(e,t){e.effect&&(e=e.effect.fn);const s=new H(e);t&&(h(s,t),t.scope&&_(s,t.scope)),(!t||!t.lazy)&&s.run();const n=s.run.bind(s);return n.effect=s,n}(e,{scheduler:()=>fe(s)});return t.effects.push(s),s}};return t},et=(e,t={})=>{const s=e.scope,n=Object.create(s);Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)),n.$refs=Object.create(s.$refs);const i=re(new Proxy(n,{set:(e,t,n,o)=>o!==i||e.hasOwnProperty(t)?Reflect.set(e,t,n,o):Reflect.set(s,t,n)}));return tt(i),{...e,scope:i}},tt=e=>{for(const t of Object.keys(e))"function"==typeof e[t]&&(e[t]=e[t].bind(e))};class st{constructor(e,s,n=!1){t(this,"template"),t(this,"ctx"),t(this,"key"),t(this,"parentCtx"),t(this,"isFragment"),t(this,"start"),t(this,"end"),this.isFragment=e instanceof HTMLTemplateElement,n?this.template=e:this.isFragment?this.template=e.content.cloneNode(!0):this.template=e.cloneNode(!0),n?this.ctx=s:(this.parentCtx=s,s.blocks.push(this),this.ctx=Ye(s)),ze(this.template,this.ctx)}get el(){return this.start||this.template}insert(e,t=null){if(this.isFragment)if(this.start){let s,n=this.start;for(;n&&(s=n.nextSibling,e.insertBefore(n,t),n!==this.end);)n=s}else this.start=new Text(""),this.end=new Text(""),e.insertBefore(this.end,t),e.insertBefore(this.start,this.end),e.insertBefore(this.template,this.end);else e.insertBefore(this.template,t)}remove(){if(this.parentCtx&&((e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)})(this.parentCtx.blocks,this),this.start){const e=this.start.parentNode;let t,s=this.start;for(;s&&(t=s.nextSibling,e.removeChild(s),s!==this.end);)s=t}else this.template.parentNode.removeChild(this.template);this.teardown()}teardown(){this.ctx.blocks.forEach((e=>{e.teardown()})),this.ctx.effects.forEach(D),this.ctx.cleanups.forEach((e=>e()))}}const nt=e=>e.replace(/[-.*+?^${}()|[\]\/\\]/g,"\\$&"),it=e=>{const t=Ye();if(e&&(t.scope=re(e),tt(t.scope),e.$delimiters)){const[s,n]=t.delimiters=e.$delimiters;t.delimitersRE=new RegExp(nt(s)+"([^]+?)"+nt(n),"g")}let s;return t.scope.$s=Re,t.scope.$nextTick=pe,t.scope.$refs=Object.create(null),{directive(e,s){return s?(t.dirs[e]=s,this):t.dirs[e]},mount(e){if("string"==typeof e&&!(e=document.querySelector(e)))return;let n;return n=(e=e||document.documentElement).hasAttribute("v-scope")?[e]:[...e.querySelectorAll("[v-scope]")].filter((e=>!e.matches("[v-scope] [v-scope]"))),n.length||(n=[e]),s=n.map((e=>new st(e,t,!0))),this},unmount(){s.forEach((e=>e.teardown()))}}},ot=document.currentScript;ot&&ot.hasAttribute("init")&&it().mount();let rt=e=>{if("function"==typeof e)return e;return function(){return e}};const lt="undefined"!=typeof self?self:null,at="undefined"!=typeof window?window:null,ht=lt||at||ht,ct=0,ut=1,dt=2,pt=3,ft="closed",mt="errored",gt="joined",yt="joining",vt="leaving",bt="phx_close",wt="phx_error",kt="phx_join",Ct="phx_reply",Et="phx_leave",Tt="longpoll",St="websocket",jt=4;class _t{constructor(e,t,s,n){this.channel=e,this.event=t,this.payload=s||function(){return{}},this.receivedResp=null,this.timeout=n,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,_ref:s}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,(e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}class Rt{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}class $t{constructor(e,t,s){this.state=ft,this.topic=e,this.params=rt(t||{}),this.socket=s,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new _t(this,kt,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new Rt((()=>{this.socket.isConnected()&&this.rejoin()}),this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError((()=>this.rejoinTimer.reset()))),this.stateChangeRefs.push(this.socket.onOpen((()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()}))),this.joinPush.receive("ok",(()=>{this.state=gt,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this.joinPush.receive("error",(()=>{this.state=mt,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.onClose((()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ft,this.socket.remove(this)})),this.onError((e=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,e),this.isJoining()&&this.joinPush.reset(),this.state=mt,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.joinPush.receive("timeout",(()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new _t(this,Et,rt({}),this.timeout).send(),this.state=mt,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.on(Ct,((e,t)=>{this.trigger(this.replyEventName(t),e)}))}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(bt,e)}onError(e){return this.on(wt,(t=>e(t)))}on(e,t){let s=this.bindingRef++;return this.bindings.push({event:e,ref:s,callback:t}),s}off(e,t){this.bindings=this.bindings.filter((s=>!(s.event===e&&(void 0===t||t===s.ref))))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,s=this.timeout){if(t=t||{},!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let n=new _t(this,e,(function(){return t}),s);return this.canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=vt;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(bt,"leave")},s=new _t(this,Et,rt({}),e);return s.receive("ok",(()=>t())).receive("timeout",(()=>t())),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(e,t,s){return t}isMember(e,t,s,n){return this.topic===e&&(!n||n===this.joinRef()||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:s,joinRef:n}),!1))}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=yt,this.joinPush.resend(e))}trigger(e,t,s,n){let i=this.onMessage(e,t,s,n);if(t&&!i)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let o=this.bindings.filter((t=>t.event===e));for(let e=0;e<o.length;e++){o[e].callback(i,s,n||this.joinRef())}}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===ft}isErrored(){return this.state===mt}isJoined(){return this.state===gt}isJoining(){return this.state===yt}isLeaving(){return this.state===vt}}class xt{static request(e,t,s,n,i,o,r){if(ht.XDomainRequest){let s=new ht.XDomainRequest;return this.xdomainRequest(s,e,t,n,i,o,r)}{let l=new ht.XMLHttpRequest;return this.xhrRequest(l,e,t,s,n,i,o,r)}}static xdomainRequest(e,t,s,n,i,o,r){return e.timeout=i,e.open(t,s),e.onload=()=>{let t=this.parseJSON(e.responseText);r&&r(t)},o&&(e.ontimeout=o),e.onprogress=()=>{},e.send(n),e}static xhrRequest(e,t,s,n,i,o,r,l){return e.open(t,s,!0),e.timeout=o,e.setRequestHeader("Content-Type",n),e.onerror=()=>l&&l(null),e.onreadystatechange=()=>{if(e.readyState===jt&&l){let t=this.parseJSON(e.responseText);l(t)}},r&&(e.ontimeout=r),e.send(i),e}static parseJSON(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let s=[];for(var n in e){if(!Object.prototype.hasOwnProperty.call(e,n))continue;let i=t?`${t}[${n}]`:n,o=e[n];"object"==typeof o?s.push(this.serialize(o,i)):s.push(encodeURIComponent(i)+"="+encodeURIComponent(o))}return s.join("&")}static appendParams(e,t){if(0===Object.keys(t).length)return e;let s=e.match(/\?/)?"&":"?";return`${e}${s}${this.serialize(t)}`}}class At{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=ct,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+St),"$1/"+Tt)}endpointURL(){return xt.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(e,t,s){this.close(e,t,s),this.readyState=ct}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===ut||this.readyState===ct}poll(){this.ajax("GET",null,(()=>this.ontimeout()),(e=>{if(e){var{status:t,token:s,messages:n}=e;this.token=s}else t=0;switch(t){case 200:n.forEach((e=>{setTimeout((()=>this.onmessage({data:e})),0)})),this.poll();break;case 204:this.poll();break;case 410:this.readyState=ut,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${t}`)}}))}send(e){this.ajax("POST",e,(()=>this.onerror("timeout")),(e=>{e&&200===e.status||(this.onerror(e&&e.status),this.closeAndRetry(1011,"internal server error",!1))}))}close(e,t,s){for(let e of this.reqs)e.abort();this.readyState=pt;let n=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:e,reason:t,wasClean:s});"undefined"!=typeof CloseEvent?this.onclose(new CloseEvent("close",n)):this.onclose(n)}ajax(e,t,s,n){let i;i=xt.request(e,this.endpointURL(),"application/json",t,this.timeout,(()=>{this.reqs.delete(i),s()}),(e=>{this.reqs.delete(i),this.isActive()&&n(e)})),this.reqs.add(i)}}const Ot={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(e,t){if(e.payload.constructor===ArrayBuffer)return t(this.binaryEncode(e));{let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}},decode(e,t){if(e.constructor===ArrayBuffer)return t(this.binaryDecode(e));{let[s,n,i,o,r]=JSON.parse(e);return t({join_ref:s,ref:n,topic:i,event:o,payload:r})}},binaryEncode(e){let{join_ref:t,ref:s,event:n,topic:i,payload:o}=e,r=this.META_LENGTH+t.length+s.length+i.length+n.length,l=new ArrayBuffer(this.HEADER_LENGTH+r),a=new DataView(l),h=0;a.setUint8(h++,this.KINDS.push),a.setUint8(h++,t.length),a.setUint8(h++,s.length),a.setUint8(h++,i.length),a.setUint8(h++,n.length),Array.from(t,(e=>a.setUint8(h++,e.charCodeAt(0)))),Array.from(s,(e=>a.setUint8(h++,e.charCodeAt(0)))),Array.from(i,(e=>a.setUint8(h++,e.charCodeAt(0)))),Array.from(n,(e=>a.setUint8(h++,e.charCodeAt(0))));var c=new Uint8Array(l.byteLength+o.byteLength);return c.set(new Uint8Array(l),0),c.set(new Uint8Array(o),l.byteLength),c.buffer},binaryDecode(e){let t=new DataView(e),s=t.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.push:return this.decodePush(e,t,n);case this.KINDS.reply:return this.decodeReply(e,t,n);case this.KINDS.broadcast:return this.decodeBroadcast(e,t,n)}},decodePush(e,t,s){let n=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),r=this.HEADER_LENGTH+this.META_LENGTH-1,l=s.decode(e.slice(r,r+n));r+=n;let a=s.decode(e.slice(r,r+i));r+=i;let h=s.decode(e.slice(r,r+o));return r+=o,{join_ref:l,ref:null,topic:a,event:h,payload:e.slice(r,e.byteLength)}},decodeReply(e,t,s){let n=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),r=t.getUint8(4),l=this.HEADER_LENGTH+this.META_LENGTH,a=s.decode(e.slice(l,l+n));l+=n;let h=s.decode(e.slice(l,l+i));l+=i;let c=s.decode(e.slice(l,l+o));l+=o;let u=s.decode(e.slice(l,l+r));l+=r;let d=e.slice(l,e.byteLength);return{join_ref:a,ref:h,topic:c,event:Ct,payload:{status:u,response:d}}},decodeBroadcast(e,t,s){let n=t.getUint8(1),i=t.getUint8(2),o=this.HEADER_LENGTH+2,r=s.decode(e.slice(o,o+n));o+=n;let l=s.decode(e.slice(o,o+i));return o+=i,{join_ref:null,ref:null,topic:r,event:l,payload:e.slice(o,e.byteLength)}}};class Pt{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||1e4,this.transport=t.transport||ht.WebSocket||At,this.establishedConnections=0,this.defaultEncoder=Ot.encode.bind(Ot),this.defaultDecoder=Ot.decode.bind(Ot),this.closeWasClean=!1,this.binaryType=t.binaryType||"arraybuffer",this.connectClock=1,this.transport!==At?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let s=null;at&&at.addEventListener&&(at.addEventListener("pagehide",(e=>{this.conn&&(this.disconnect(),s=this.connectClock)})),at.addEventListener("pageshow",(e=>{s===this.connectClock&&(s=null,this.connect())}))),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=e=>t.rejoinAfterMs?t.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4,this.reconnectAfterMs=e=>t.reconnectAfterMs?t.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3,this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=rt(t.params||{}),this.endPoint=`${e}/${St}`,this.vsn=t.vsn||"2.0.0",this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Rt((()=>{this.teardown((()=>this.connect()))}),this.reconnectAfterMs)}getLongPollTransport(){return At}replaceTransport(e){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.sendBuffer=[],this.conn&&(this.conn.close(),this.conn=null),this.transport=e}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=xt.appendParams(xt.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,s){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,s)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=rt(e)),this.conn||(this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=e=>this.onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this.onConnClose(e))}log(e,t,s){this.logger(e,t,s)}hasLogger(){return null!==this.logger}onOpen(e){let t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}onClose(e){let t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}onError(e){let t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}onMessage(e){let t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}ping(e){if(!this.isConnected())return!1;let t=this.makeRef(),s=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:t});let n=this.onMessage((i=>{i.ref===t&&(this.off([n]),e(Date.now()-s))}));return!0}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach((([,e])=>e()))}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.abnormalClose("heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearTimeout(this.heartbeatTimer),setTimeout((()=>this.sendHeartbeat()),this.heartbeatIntervalMs))}teardown(e,t,s){if(!this.conn)return e&&e();this.waitForBufferDone((()=>{this.conn&&(t?this.conn.close(t,s||""):this.conn.close()),this.waitForSocketClosed((()=>{this.conn&&(this.conn.onclose=function(){},this.conn=null),e&&e()}))}))}waitForBufferDone(e,t=1){5!==t&&this.conn&&this.conn.bufferedAmount?setTimeout((()=>{this.waitForBufferDone(e,t+1)}),150*t):e()}waitForSocketClosed(e,t=1){5!==t&&this.conn&&this.conn.readyState!==pt?setTimeout((()=>{this.waitForSocketClosed(e,t+1)}),150*t):e()}onConnClose(e){let t=e&&e.code;this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearTimeout(this.heartbeatTimer),this.closeWasClean||1e3===t||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((([,t])=>t(e)))}onConnError(e){this.hasLogger()&&this.log("transport",e);let t=this.transport,s=this.establishedConnections;this.stateChangeCallbacks.error.forEach((([,n])=>{n(e,t,s)})),(t===this.transport||s>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach((e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(wt)}))}connectionState(){switch(this.conn&&this.conn.readyState){case ct:return"connecting";case ut:return"open";case dt:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter((t=>t.joinRef()!==e.joinRef()))}off(e){for(let t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter((([t])=>-1===e.indexOf(t)))}channel(e,t={}){let s=new $t(e,t,this);return this.channels.push(s),s}push(e){if(this.hasLogger()){let{topic:t,event:s,payload:n,ref:i,join_ref:o}=e;this.log("push",`${t} ${s} (${o}, ${i})`,n)}this.isConnected()?this.encode(e,(e=>this.conn.send(e))):this.sendBuffer.push((()=>this.encode(e,(e=>this.conn.send(e)))))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimer=setTimeout((()=>this.heartbeatTimeout()),this.heartbeatIntervalMs))}abnormalClose(e){this.closeWasClean=!1,this.isConnected()&&this.conn.close(1e3,e)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:n,ref:i,join_ref:o}=e;i&&i===this.pendingHeartbeatRef&&(clearTimeout(this.heartbeatTimer),this.pendingHeartbeatRef=null,setTimeout((()=>this.sendHeartbeat()),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${n.status||""} ${t} ${s} ${i&&"("+i+")"||""}`,n);for(let e=0;e<this.channels.length;e++){const r=this.channels[e];r.isMember(t,s,n,o)&&r.trigger(s,n,i,o)}for(let t=0;t<this.stateChangeCallbacks.message.length;t++){let[,s]=this.stateChangeCallbacks.message[t];s(e)}}))}leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t.isJoined()||t.isJoining())));t&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${e}"`),t.leave())}}const It=15e3,Lt=(e,t,s,n)=>{if(null==t)return;const i=new Date;if(i.getTime()-t.getTime()<It)return;let o=`https://${apiUrl}/listening_session/`;null!==s&&(o+=s);const r={date_time_start:t.toISOString(),date_time_end:i.toISOString(),source:"seo",ctrl:Math.random()};return!0===n&&(r.ending=!0),e.includes("-")?r.stream_id=e:r.radio_stream_code_name=`${e}_main`,fetch(o,{method:null!==s?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((e=>e.json())).then((e=>void 0!==e.id?e:null))},Nt=e=>{const t=document.getElementById("playing-alert");t&&(!0===e?t.classList.remove("d-none"):t.classList.add("d-none"))},Mt=e=>{e?window.audio.volume=e:"undefined"!=typeof appVolume&&(window.audio.volume=appVolume)};it({hls:null,dash:null,socket:null,socketTimer:null,channels:{},playing:1,song:null,listeners:null,lastUpdated:null,radioId:null,playingStart:null,sessionId:null,listeningInterval:null,options:{webSocket:"undefined"==typeof appWebSocket||appWebSocket,sendStatistics:"undefined"==typeof appSendStatistics||appSendStatistics},play(e,t,s){s||(s={}),Nt(!1),1!==this.playing&&this.stop(),null!==this.listeningInterval&&(clearInterval(this.listeningInterval),this.listeningInterval=null),this.options.sendStatistics&&sendGaEvent("play","SSR",t,3),this.playing=42,this.radioId=t,this.sessionId=null,this.playerStart=new Date,-1!==e.indexOf(".m3u8")||s.force_hls&&!0===s.force_hls?new Promise(((e,t)=>{if(null!==document.getElementById("hls-script"))return void e();const s=document.createElement("script");s.type="text/javascript",s.id="hls-script",s.src="/js/hls.light.min.js",s.onload=e,s.onerror=t,document.body.appendChild(s)})).then((()=>{Hls.isSupported()&&(window.audio=document.getElementById("videoplayer"),this.hls=new Hls,this.hls.attachMedia(window.audio),this.hls.on(Hls.Events.ERROR,((e,s)=>{s.fatal&&this.playingError(t,s.details)})),this.hls.on(Hls.Events.MEDIA_ATTACHED,(()=>{this.hls.loadSource(e),this.hls.on(Hls.Events.MANIFEST_PARSED,(()=>{Mt(),window.audio.play().then((()=>{this.playingStarted(s.topic?s.topic.trim():null,s.streamCodeName?s.streamCodeName.trim():null)}))}))})))})):-1!==e.indexOf(".mpd")||s.force_mpd&&!0===s.force_mpd?new Promise(((e,t)=>{if(null!==document.getElementById("dash-script"))return void e(!0);const s=document.createElement("script");s.type="text/javascript",s.id="dash-script",s.src="/js/dash.all.min.js",s.onload=e,s.onerror=t,document.body.appendChild(s)})).then((()=>{window.audio=document.getElementById("videoplayer"),this.dash=dashjs.MediaPlayer().create(),this.dash.initialize(window.audio,e,!1),this.dash.on("error",(()=>{this.playingError(t)})),this.dash.on("canPlay",(()=>{Mt(),window.audio.play().then((()=>{this.playingStarted(s.topic?s.topic.trim():null,s.streamCodeName?s.streamCodeName.trim():null)}))}))})):(window.audio=document.getElementById("videoplayer"),window.audio.src=e.trim(),Mt(),window.audio.onerror=n=>{if("https"!==e.trim().substring(0,5))return this.stop(),void this.play(`${streamsProxy}?k=${streamsProxyKey}&stream=${e}`,t,s.topic,s.streamCodeName);this.playingError(t,n.target.error.message||null)},window.audio.play().then((()=>{this.playingStarted(s.topic?s.topic.trim():null,s.streamCodeName?s.streamCodeName.trim():null)})))},stop(){void 0!==window.audio&&null!==window.audio&&window.audio.pause(),null!==this.listeningInterval&&(clearInterval(this.listeningInterval),this.listeningInterval=null),null!==this.hls&&(this.hls.destroy(),this.hls=null),null!==this.dash&&(this.dash.destroy(),this.dash=null),window.audio=null,delete window.audio,!1!==this.playing&&this.options.sendStatistics&&(Lt(this.radioId,this.playingStart,this.sessionId,!0),sendGaEvent("stop","SSR",this.radioId,1)),this.playing=1,this.radioId=null,this.listeningInterval=null,this.sessionId=null,this.playingStart=null},playingStarted(e,t){this.playing=3,this.lastUpdated=new Date,this.playingStart=new Date,this.options.sendStatistics&&(this.listeningInterval=setInterval((()=>{Lt(this.radioId,this.playingStart,this.sessionId).then((e=>{null!==e.id&&(this.sessionId=e.id,this.playingStart=new Date(e.date_time_start))}))}),It),setTimeout((()=>{var e;e=this.radioId,"dev"===appEnv&&e.includes("-")&&fetch(`https://${apiUrl}/config`,{headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((t=>{t&&t.radio_browser_url&&fetch(`${t.radio_browser_url}/json/url/${e}`,{headers:{"User-Agent":isProgRadio?"programmes-radio.com":"radio-addict.com"}})})).catch((function(e){}))}),15500)),window.audio.addEventListener("timeupdate",(()=>{this.lastUpdated=new Date})),null!=e&&""!==e&&this.joinChannel(e.trim()),null!=t&&""!==t&&this.joinChannel(`listeners:${t}`)},playingError(e,t){setTimeout((()=>{this.playing=1,Nt(!0),this.options.sendStatistics&&((e,t)=>{if(!e.includes("-"))return;let s=`https://${apiUrl}/stream_error/${e}`;const n={};t&&(n.error=t),fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>e.json()))})(e,t)}),2500)},connectSocket(){if(this.options.webSocket){if(!this.socket){const e={heartbeatIntervalMs:5e4,reconnectAfterMs:e=>e>=50?null:[10,50,100,150,200,250,500,1e3,2e3,5e3,1e4,2e4][e-1]||3e4};this.socket=new Pt(`wss://${apiUrl}/socket`,e),this.socket.onOpen((()=>{this.setSocketTimer()})),this.socket.onClose((()=>{this.song=null,this.listeners=null,this.clearSocketTimer()}))}this.socket&&!this.socket.isConnected()&&this.socket.connect()}},setSocketTimer(){this.clearSocketTimer(),this.socketTimer=setTimeout((()=>{this.socket&&(this.socket.disconnect(),this.socketTimer=null)}),36e6)},clearSocketTimer(){this.socketTimer&&(clearTimeout(this.socketTimer),this.socketTimer=null)},joinChannel(e){this.options.webSocket&&(this.connectSocket(),Object.prototype.hasOwnProperty.call(this.channels,e)||(this.channels[e]=this.socket.channel(e,{}),this.channels[e].join().receive("error",(t=>{e.startsWith("listeners:")?this.listeners=null:this.song=null})).receive("timeout",(()=>{e.startsWith("listeners:")?this.listeners=null:this.song=null})),this.channels[e].on("playing",(e=>{this.formatSong(e)})),this.channels[e].on("counter_update",(e=>{this.formatListeners(e)})),this.channels[e].on("quit",(()=>{this.song=null,this.listeners=null,this.channels[e]=null,delete this.channels[e]}))))},formatSong(e){if(null===!e||!e.song)return void(this.song=null);let t="",s=!1;void 0!==e.song.artist&&null!==e.song.artist&&""!==e.song.artist&&(t+=e.song.artist,s=!0),void 0!==e.song.title&&null!==e.song.title&&""!==e.song.title&&(!0===s&&(t+=" - "),t+=e.song.title),this.song=""===t?null:t},formatListeners(e){e&&e.listeners&&0!==!e.listeners?this.listeners=e.listeners:this.listeners=null}}).mount()})();
{% endverbatim %}
</script>
